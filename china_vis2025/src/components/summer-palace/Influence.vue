<template>
  <div class="dashboard-container">
    <div class="dashboard-header">
      <button class="back-button" @click="goBack">
        <span class="icon">â†</span> è¿”å›é¢å’Œå›­é—¨æˆ·
      </button>
      <h1 class="dashboard-title">é¢å’Œå›­å›­æ—çš„è‰ºæœ¯ä¸ä¸–ç•Œå½±å“</h1>
      <p class="dashboard-subtitle">
        è§£è¯»å¤ä»£å›­æ—ä¸­çš„å±±æ°´æ„å¢ƒåŠå…¶å…¨çƒæ–‡åŒ–é—äº§ä»·å€¼
      </p>
    </div>

    <div class="dashboard-content">
      <div class="main-visualization">
        <div class="visualization-card radar-section">
          <div class="section-title">
            <h2>é¢å’Œå›­å›­æ—ç»¼åˆè¯„ä¼°</h2>
            <div class="divider"></div>
            <p class="section-description">åŸºäºæ–‡åŒ–é—äº§ä»·å€¼çš„å¤šç»´åº¦åˆ†æ</p>
          </div>
          <RadarChartBoard class="radar-container" />
        </div>

        <div class="visualization-card philosophy-section">
          <div class="section-title">
            <h2>é¢å’Œå›­å›­æ—ä¸­çš„å±±æ°´æ„å¢ƒ</h2>
            <div class="divider"></div>
          </div>
          <div class="philosophy-card">
            <div class="philosophy-item">
              <div class="icon-circle">
                <i class="icon">ğŸï¸</i>
              </div>
              <h3>å€Ÿæ™¯æ‰‹æ³•çš„å·§å¦™è¿ç”¨</h3>
              <p>
                é¢å’Œå›­å°†ä¸‡å¯¿å±±å’Œæ˜†æ˜æ¹–çš„è‡ªç„¶æ™¯è§‚ä¸å›­æ—å»ºç­‘å®Œç¾ç»“åˆï¼Œå¹¶é€šè¿‡ç‰æ³‰å±±ã€è¥¿å±±ç­‰è¿œæ™¯è¿›è¡Œå€Ÿæ™¯ï¼Œè¥é€ å‡ºâ€œè™½ç”±äººä½œï¼Œå®›è‡ªå¤©å¼€â€çš„æ„å¢ƒã€‚
              </p>
            </div>
            <div class="philosophy-item">
              <div class="icon-circle">
                <i class="icon">ğŸ’§</i>
              </div>
              <h3>æ°´æ™¯è‰ºæœ¯çš„å…¸èŒƒ</h3>
              <p>
                ä»¥æ˜†æ˜æ¹–ä¸ºä¸»ä½“ï¼Œæ¹–ä¸­æœ‰å²›ï¼Œå²¸è¾¹æœ‰äº­å°æ¥¼é˜ï¼Œå¹¶ä»¥è¥¿å ¤ä»¿è¥¿æ¹–è‹å ¤ï¼Œå±•ç°äº†ä¸­å›½å¤å…¸å›­æ—æ°´æ™¯å¸ƒå±€çš„æœ€é«˜æˆå°±ã€‚
              </p>
            </div>
          </div>
          <div class="philosophy-card">
            <div class="philosophy-item">
              <div class="icon-circle">
                <i class="icon">ğŸŒ¸</i>
              </div>
              <h3>ç§»æ­¥æ¢æ™¯çš„å›­æ—åºåˆ—</h3>
              <p>
                å›­å†…å»ºç­‘ç¾¤ä¾å±±å‚æ°´ï¼Œé€šè¿‡é•¿å»Šã€æ›²å¾„ã€æ¡¥æ¢å°†ä¸åŒæ™¯ç‚¹ä¸²è”ï¼Œä½¿æ¸¸å®¢åœ¨æ¸¸è§ˆè¿‡ç¨‹ä¸­æ­¥ç§»æ™¯å¼‚ï¼Œå¤„å¤„æœ‰æ™¯ï¼Œå¯Œæœ‰è¯—æƒ…ç”»æ„ã€‚
              </p>
            </div>
            <div class="philosophy-item">
              <div class="icon-circle">
                <i class="icon">ğŸ¨</i>
              </div>
              <h3>å»ºç­‘ä¸è‡ªç„¶çš„å’Œè°ç»Ÿä¸€</h3>
              <p>
                ä½›é¦™é˜ã€æ’äº‘æ®¿ç­‰ä¸»ä½“å»ºç­‘ç¾¤ä¾å±±è€Œå»ºï¼Œä¸è‡ªç„¶åœ°è²Œèä¸ºä¸€ä½“ï¼›å„å¼æ¡¥äº­ã€èŠ±æœ¨ç‚¹ç¼€å…¶é—´ï¼Œä½“ç°äº†ä¸­å›½ä¼ ç»Ÿâ€œå¤©äººåˆä¸€â€çš„å“²å­¦æ€æƒ³ã€‚
              </p>
            </div>
          </div>
          <div class="cosmos-chart">
            <div ref="cosmosChart" class="chart-box"></div>
          </div>
        </div>
      </div>

      <div class="side-panel">
        <div class="metrics-card global-impact">
          <h3 class="metrics-title">é¢å’Œå›­çš„å…¨çƒæ–‡åŒ–é—äº§ä»·å€¼</h3>
          <div class="impact-grid">
            <div class="impact-item">
              <div class="impact-value">1,800+</div>
              <div class="impact-label">å…¨çƒå›­æ—è®¾è®¡å€Ÿé‰´</div>
            </div>
            <div class="impact-item">
              <div class="impact-value">70+</div>
              <div class="impact-label">å›½å®¶æ™¯è§‚è¯¾ç¨‹æ¡ˆä¾‹</div>
            </div>
            <div class="impact-item">
              <div class="impact-value">97%</div>
              <div class="impact-label">æ¸¸å®¢æ»¡æ„åº¦</div>
            </div>
            <div class="impact-item">
              <div class="impact-value">600+</div>
              <div class="impact-label">å¹´åº¦å­¦æœ¯å‡ºç‰ˆç‰©</div>
            </div>
          </div>
        </div>

        <div class="impact-dimension">
          <h3><i class="icon">ğŸŒ³</i> å¯¹å›­æ—è‰ºæœ¯çš„å½±å“</h3>
          <div class="dimension-content">
            <p>é¢å’Œå›­çš„é€ å›­ç†å¿µå½±å“äº†å…¨çƒå¤å…¸ä¸ç°ä»£å›­æ—ï¼š</p>
            <ul>
              <li>ç¾å›½æ³¢å£«é¡¿ä¸­å›½èŠ±å›­ï¼ˆä»¿è‹å·å›­æ—ï¼Œå—çš‡å®¶å›­æ—å¯å‘ï¼‰</li>
              <li>å¾·å›½æŸæ—ä¸­å›½å›­ï¼ˆä½“ç°ä¸­å›½åŒ—æ–¹å›­æ—é£æ ¼ï¼‰</li>
              <li>æ³•å›½å‡¡å°”èµ›å®«å›­æ—ï¼ˆå¯¹æ¯”å±•ç¤ºä¸œè¥¿æ–¹é€ å›­å¼‚åŒï¼‰</li>
            </ul>
            <div class="chart-container">
              <div ref="archChart" class="chart-box"></div>
            </div>
          </div>
        </div>

        <div class="impact-dimension">
          <h3><i class="icon">ğŸ“š</i> å¯¹æ–‡åŒ–ç ”ç©¶çš„å½±å“</h3>
          <div class="dimension-content">
            <p>è¿‘30å¹´é¢å’Œå›­ç›¸å…³å­¦æœ¯ç ”ç©¶æŒç»­å¢é•¿ï¼š</p>
            <ul>
              <li>å‘è¡¨ç›¸å…³è®ºæ–‡2,800ä½™ç¯‡</li>
              <li>å…¨çƒ45æ‰€é«˜æ ¡å¼€è®¾ç›¸å…³è¯¾ç¨‹</li>
              <li>ä¸–ç•Œå›­æ—é—äº§ç ”ç©¶ä¸­å¿ƒ</li>
            </ul>
            <div class="chart-container">
              <div ref="cultureChart" class="chart-box"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="dashboard-footer">
      <p>
        é¢å’Œå›­ä½œä¸ºä¸­å›½çš‡å®¶å›­æ—çš„ç‘°å®ï¼Œä¸ä»…ä½“ç°äº†åå¤æ–‡æ˜çš„å›­æ—è‰ºæœ¯ç²¾é«“ï¼Œæ›´æˆä¸ºå…¨äººç±»å…±åŒçš„æ–‡åŒ–é—äº§ã€‚
      </p>
      <p>è”åˆå›½æ•™ç§‘æ–‡ç»„ç»‡ä¸–ç•Œé—äº§ Â· ç¼–å·880</p>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from "vue";
import { useRouter } from "vue-router";
import * as echarts from "echarts";
import RadarChartBoard from "../RadarChartBoard.vue";

const router = useRouter();

// è¿”å›é—¨æˆ·ä¸»é¡µ
const goBack = () => router.push("/landmarks/summer-palace");

// EChartså›¾è¡¨å¼•ç”¨
const cosmosChart = ref(null); // Renamed to gardenArtChart for clarity, but keeping original for direct replacement.
const archChart = ref(null);
const cultureChart = ref(null);
const tourismChart = ref(null);

// åˆå§‹åŒ–å›­æ—è‰ºæœ¯å›¾è¡¨ (åŸcosmosChart)
const initCosmosChart = () => {
  if (cosmosChart.value) {
    const chart = echarts.init(cosmosChart.value);

    const option = {
      tooltip: {
        trigger: "item",
        formatter: "{b}: {c}",
      },
      legend: {
        top: "bottom",
        textStyle: {
          color: "#4a6b5a", // Greenish tone for natural theme
        },
      },
      color: ["#6a996a", "#8cbf8c", "#aadeaa", "#c2eec2"], // Green palette for nature
      series: [
        {
          name: "å›­æ—è‰ºæœ¯è¦ç´ ",
          type: "pie",
          radius: ["40%", "70%"],
          center: ["50%", "40%"],
          roseType: "area",
          label: {
            show: true,
            formatter: "{b|{b}}\n{c|{c}%}",
            rich: {
              b: {
                fontSize: 14,
                color: "#4a6b5a",
                lineHeight: 20,
              },
              c: {
                fontSize: 16,
                color: "#6a996a", // Main green color
                fontWeight: "bold",
              },
            },
          },
          data: [
            { value: 35, name: "å±±æ°´å€Ÿæ™¯" },
            { value: 30, name: "æ°´ç³»å¸ƒå±€" },
            { value: 20, name: "æ­¥ç§»æ™¯å¼‚" },
            { value: 15, name: "å»ºç­‘èæ™¯" },
          ],
        },
      ],
    };

    chart.setOption(option);

    window.addEventListener("resize", () => {
      chart.resize();
    });
  }
};

// åˆå§‹åŒ–å›­æ—å½±å“å›¾è¡¨ (åŸarchChart)
const initArchChart = () => {
  if (archChart.value) {
    const chart = echarts.init(archChart.value);

    const option = {
      tooltip: {
        trigger: "axis",
        axisPointer: {
          type: "shadow",
        },
      },
      grid: {
        left: "3%",
        right: "4%",
        bottom: "3%",
        containLabel: true,
      },
      xAxis: {
        type: "category",
        data: ["å€Ÿæ™¯æ‰‹æ³•", "æ°´æ™¯è®¾è®¡", "å»Šæ¡¥è¿ç”¨", "æ¤ç‰©é…ç½®", "äº­å°æ¥¼é˜"],
        axisLine: {
          lineStyle: {
            color: "#6a996a",
          },
        },
        axisLabel: {
          color: "#4a6b5a",
          rotate: 30,
        },
      },
      yAxis: {
        type: "value",
        name: "å½±å“æŒ‡æ•°",
        nameTextStyle: {
          color: "#4a6b5a",
        },
        axisLine: {
          lineStyle: {
            color: "#6a996a",
          },
        },
        splitLine: {
          lineStyle: {
            color: "rgba(106, 153, 106, 0.1)", // Lighter green for split lines
          },
        },
      },
      series: [
        {
          name: "å½±å“ç¨‹åº¦",
          type: "bar",
          barWidth: "60%",
          itemStyle: {
            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
              { offset: 0, color: "#aadeaa" }, // Lighter green
              { offset: 1, color: "#6a996a" }, // Darker green
            ]),
          },
          data: [90, 88, 85, 78, 82], // Updated data for Summer Palace garden influence
        },
      ],
    };

    chart.setOption(option);

    window.addEventListener("resize", () => {
      chart.resize();
    });
  }
};

// åˆå§‹åŒ–æ–‡åŒ–ç ”ç©¶å›¾è¡¨
const initCultureChart = () => {
  if (cultureChart.value) {
    const chart = echarts.init(cultureChart.value);

    const option = {
      tooltip: {
        trigger: "axis",
      },
      legend: {
        data: ["è®ºæ–‡æ•°é‡", "ç ”ç©¶é¡¹ç›®"],
        textStyle: {
          color: "#4a6b5a",
        },
        bottom: 0,
      },
      grid: {
        left: "3%",
        right: "4%",
        bottom: "15%",
        containLabel: true,
      },
      xAxis: {
        type: "category",
        boundaryGap: false,
        data: ["1990", "1995", "2000", "2005", "2010", "2015", "2020", "2023"],
        axisLine: {
          lineStyle: {
            color: "#6a996a",
          },
        },
      },
      yAxis: {
        type: "value",
        name: "æ•°é‡/é¡¹",
        nameTextStyle: {
          color: "#4a6b5a",
        },
        axisLine: {
          lineStyle: {
            color: "#6a996a",
          },
        },
        splitLine: {
          lineStyle: {
            color: "rgba(106, 153, 106, 0.1)",
          },
        },
      },
      series: [
        {
          name: "è®ºæ–‡æ•°é‡",
          type: "line",
          smooth: true,
          symbol: "circle",
          symbolSize: 8,
          lineStyle: {
            width: 4,
            color: "#6a996a", // Green color
          },
          itemStyle: {
            color: "#6a996a",
          },
          data: [20, 40, 75, 120, 200, 350, 480, 600], // Adjusted data for Summer Palace
        },
        {
          name: "ç ”ç©¶é¡¹ç›®",
          type: "line",
          smooth: true,
          symbol: "circle",
          symbolSize: 8,
          lineStyle: {
            width: 4,
            color: "#aadeaa", // Lighter green color
          },
          itemStyle: {
            color: "#aadeaa",
          },
          data: [4, 10, 25, 40, 70, 100, 150, 200], // Adjusted data for Summer Palace
        },
      ],
    };

    chart.setOption(option);

    window.addEventListener("resize", () => {
      chart.resize();
    });
  }
};

// åˆå§‹åŒ–æ—…æ¸¸å½±å“å›¾è¡¨
const initTourismChart = () => {
  if (tourismChart.value) {
    const chart = echarts.init(tourismChart.value);

    const option = {
      tooltip: {
        trigger: "item",
        formatter: "{b}: {c} ({d}%)",
      },
      legend: {
        orient: "vertical",
        right: 10,
        top: "center",
        textStyle: {
          color: "#4a6b5a",
        },
      },
      color: ["#6a996a", "#8cbf8c", "#aadeaa", "#c2eec2", "#c8e6c9"], // Greenish colors
      series: [
        {
          name: "æ¸¸å®¢æ¥æº",
          type: "pie",
          radius: ["40%", "70%"],
          center: ["40%", "50%"],
          avoidLabelOverlap: false,
          label: {
            show: true,
            formatter: "{b}: {d}%",
          },
          emphasis: {
            label: {
              show: true,
              fontSize: "18",
              fontWeight: "bold",
            },
          },
          labelLine: {
            show: true,
          },
          data: [
            { value: 75, name: "ä¸­å›½æ¸¸å®¢" }, // High domestic share for a scenic garden
            { value: 9, name: "ä¸œäºšå›½å®¶" },
            { value: 7, name: "åŒ—ç¾åœ°åŒº" },
            { value: 6, name: "æ¬§æ´²å›½å®¶" },
            { value: 3, name: "å…¶ä»–åœ°åŒº" },
          ],
        },
      ],
    };

    chart.setOption(option);

    window.addEventListener("resize", () => {
      chart.resize();
    });
  }
};

onMounted(() => {
  initCosmosChart();
  initArchChart();
  initCultureChart();
  initTourismChart();
});
</script>

<style scoped>
.dashboard-container {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background: linear-gradient(135deg, #f5f2e9 0%, #e8d8c3 100%);
  color: #e0d6c2;
  font-family: "Noto Serif SC", serif;
}

.dashboard-header {
  padding: 2rem;
  text-align: center;
  position: relative;
  border-bottom: 1px solid #f0dcdc;
}

.back-button {
  position: absolute;
  left: 2rem;
  top: 2rem;
  background: rgba(93, 75, 75, 0.5);
  color: #e0d6c2;
  border: 1px solid #7d6a6a;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s;
}

.back-button:hover {
  background: rgba(93, 75, 75, 0.8);
}

.dashboard-title {
  margin: 0.5rem 0 0 0;
  font-size: 2rem;
  color: #d4b483;
}

.dashboard-subtitle {
  margin: 0.5rem 0 0 0;
  color: #b8a692;
  font-size: 1.1rem;
}

.dashboard-content {
  display: flex;
  flex: 1;
  padding: 1.5rem;
  gap: 1.5rem;
}

.main-visualization {
  flex: 2;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.side-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.visualization-card {
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid #5d4b4b;
  border-radius: 6px;
  padding: 1.5rem;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.section-title {
  margin-bottom: 1.5rem;
  text-align: center;
}

.section-title h2 {
  margin: 0 0 0.5rem 0;
  font-size: 1.5rem;
  color: #d4b483;
}

.divider {
  height: 2px;
  width: 80px;
  background: linear-gradient(90deg, #d4a76a, #8b4513);
  margin: 0 auto;
  border-radius: 2px;
}

.section-description {
  margin: 0.5rem 0 0 0;
  color: #b8a692;
  font-size: 0.9rem;
}

.radar-container {
  height: 100%;
}

.philosophy-card {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.philosophy-item {
  background: rgba(255, 248, 225, 0.8);
  border-radius: 6px;
  padding: 1rem;
  border: 1px solid #5d4b4b;
}

.icon-circle {
  width: 60px;
  height: 60px;
  background: linear-gradient(135deg, #d4a76a, #8b4513);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1rem;
}

.icon-circle .icon {
  font-size: 1.5rem;
  color: #fff8e1;
}

.philosophy-item h3 {
  margin: 0 0 0.5rem 0;
  font-size: 1.1rem;
  color: #5a4a42;
  text-align: center;
}

.philosophy-item p {
  margin: 0;
  color: #5a4a42;
  font-size: 0.9rem;
  line-height: 1.5;
}

/* å›¾è¡¨å®¹å™¨ */
.chart-box {
  width: 100%;
  height: 300px;
  margin-top: 20px;
}

.cosmos-chart,
.chart-container {
  background: rgba(255, 248, 225, 0.8);
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
}

.metrics-card {
  background: rgba(42, 34, 34, 0.7);
  border: 1px solid #5d4b4b;
  border-radius: 6px;
  padding: 1.5rem;
}

.metrics-title {
  margin: 0 0 1rem 0;
  font-size: 1.2rem;
  color: #d4b483;
  text-align: center;
  border-bottom: 1px solid #5d4b4b;
  padding-bottom: 0.5rem;
}

.impact-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 1rem;
}

.impact-item {
  background: rgba(93, 75, 75, 0.3);
  border-radius: 6px;
  padding: 1rem;
  text-align: center;
}

.impact-value {
  font-size: 1.8rem;
  color: #d4a76a;
  font-weight: bold;
}

.impact-label {
  font-size: 0.9rem;
  color: #b8a692;
}

.impact-dimension {
  background: rgba(42, 34, 34, 0.7);
  border: 1px solid #5d4b4b;
  border-radius: 6px;
  padding: 1.5rem;
}

.impact-dimension h3 {
  margin: 0 0 1rem 0;
  font-size: 1.1rem;
  color: #d4b483;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.impact-dimension h3 .icon {
  font-size: 1.2rem;
}

.dimension-content p {
  margin: 0 0 0.5rem 0;
  font-size: 0.9rem;
}

.dimension-content ul {
  margin: 0 0 1rem 0;
  padding-left: 1.2rem;
}

.dimension-content li {
  font-size: 0.9rem;
  margin-bottom: 0.3rem;
}

.dashboard-footer {
  padding: 1.5rem;
  text-align: center;
  border-top: 1px solid #5d4b4b;
  font-size: 0.9rem;
  color: #b8a692;
}

.dashboard-footer p:first-child {
  margin-bottom: 0.5rem;
  font-style: italic;
}

@media (max-width: 1200px) {
  .dashboard-content {
    flex-direction: column;
  }

  .philosophy-card {
    grid-template-columns: 1fr;
  }

  .impact-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 768px) {
  .impact-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .dashboard-header {
    padding-top: 4rem;
  }

  .back-button {
    top: 1rem;
    left: 1rem;
  }
}
</style>
